<body>
<div class="container">
    <h2>File Management</h2>

    <form asp-action="DeleteFile" method="post">
        <label for="fileList">Select a file to delete:</label>
        <select id="fileList" name="id">
            @foreach (var item in Database.GetFiles())
            {
            <option value="@item.Id">@item.Id @item.Name</option>
            }
        </select>

        <button type="submit">Delete File</button>
    </form>
    
    <hr>

    <label for="fileUpload">Upload a new file:</label>
    <input type="file" id="fileUpload"/>
    <button id="uploadFileBtn">Upload File</button>
</div>

<script>
    // Handle file upload
    document.getElementById("uploadFileBtn").addEventListener("click", () => {
        const fileInput = document.getElementById("fileUpload");
        const file = fileInput.files[0];
        if (file) {
            const formData = new FormData();
            formData.append('file', file);

            fetch('/api/file/upload', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    populateFileList(); // Update the dropdown with the new file
                })
                .catch(_ => alert('Error uploading file.'));
        } else {
            alert("Please select a file to upload.");
        }
    });
</script>
</body>
